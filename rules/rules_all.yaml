rules:
  # ========= GEN: общие =========
  - id: GEN-IDENT-HEADER
    title: Шапка — идентификация пациента и МО
    severity: major
    required: true
    order: "Оформление"
    where: "шапка/первая страница"
    llm_question: >
      Должны быть ФИО пациента, дата рождения/возраст, пол, ИИН (если присутствует),
      номер истории, наименование медорганизации/отделения, даты поступления/выписки.
      Любое отсутствие — FAIL. Приведи короткие цитаты.

  - id: GEN-DATES-CONSISTENT
    title: Хронология без противоречий
    severity: major
    required: true
    order: "Оформление"
    where: "весь документ"
    llm_question: >
      Поступление ≤ осмотры ≤ процедуры/операции ≤ выписка. Обратные ходы времени/невозможные интервалы — FAIL.

  - id: GEN-ICD10-CODING
    title: МКБ-10 у диагноза(ов)
    severity: minor
    required: true
    order: "Диагноз"
    where: "диагнозы"
    llm_question: >
      У основного диагноза должен быть код МКБ-10; желательно у сопутствующих/осложнений. Отсутствует — FAIL (minor).

  - id: GEN-CONSENTS
    title: Информированные согласия — есть подписи и даты
    severity: major
    required: true
    order: "Меддокументация"
    where: "согласия/приложения"
    llm_question: >
      Найди согласия (лечение/операция/анестезия/переливание/ПДн). Для каждого: ФИО, подпись, дата. Нет — FAIL.

  - id: GEN-LABS-DATED
    title: Анализы/исследования — с датами
    severity: minor
    required: true
    order: "Диагностика"
    where: "анализы/протоколы"
    llm_question: >
      Значимые исследования должны иметь дату; ключевые — до клинических решений. Нет дат — FAIL (minor).

  - id: GEN-SIGNATURES
    title: Подписи и ФИО исполнителей
    severity: major
    required: true
    order: "Оформление"
    where: "концы записей/протоколов/эпикризов"
    llm_question: >
      На ключевых записях/эпикризах/протоколах — ФИО и подпись (и/или должность). Нет — FAIL.

  - id: GEN-DISCHARGE-SUMMARY
    title: Выписной эпикриз — структура
    severity: major
    required: true
    order: "Эпикриз"
    where: "выписной эпикриз"
    llm_question: >
      Должны быть: окончательный диагноз (+МКБ), обоснование, проведённое лечение, исход, рекомендации,
      режим и диета на дому, контроль/срок явки. Отсутствует существенная часть — FAIL.

  - id: GEN-MEDS-AT-DISCHARGE
    title: Препараты при выписке — доза/кратность/срок
    severity: minor
    required: true
    order: "Рекомендации"
    where: "рекомендации/лист назначений"
    llm_question: >
      Назначения: наименование, доза, кратность, длительность. Любое отсутствует — FAIL (minor).

  # ========= STAC: стационар (Приказ № 27) =========
  - id: STAC-27-ER-WARD-EXAM-30MIN
    title: Осмотр врача отделения ≤ 30 мин при экстренной госпитализации
    severity: major
    required: true
    order: "Приказ 27"
    where: "приёмное / осмотр отделения"
    llm_question: >
      Если "экстренно": сравни время осмотра приёмного и отделения. Интервал ≤ 30 мин.
      Нет времени или интервал > 30 — FAIL.

  - id: STAC-27-HEAD-PRIMARY-D0
    title: Первичный осмотр Заведующим в рабочее время
    severity: major
    required: true
    order: "Приказ 27"
    where: "первичный осмотр"
    llm_question: >
      Первичный осмотр выполняет Заведующий отделением, будни 09:00–18:00 (если не оговорено иначе).
      Другая должность/нерабочее время — FAIL.

  - id: STAC-27-DIAG-JUSTIFY-D3
    title: Обоснование диагноза ≤ 3 суток + подпись заведующего
    severity: major
    required: true
    order: "Приказ 27"
    where: "обоснование диагноза"
    llm_question: >
      Дата поступления → дата обоснования ≤ 72 часа. Нужна отметка/подпись заведующего. Иначе — FAIL.

  - id: STAC-27-PREOP-EPICRISIS-CONTENT
    title: Предоперационный эпикриз — полнота
    severity: major
    required: true
    order: "Приказ 27"
    where: "предоперационный эпикриз"
    llm_question: >
      Обязательно: показания к операции, жалобы, анамнез жизни, анамнез заболевания, соматический статус.
      Любое отсутствие — FAIL.

  - id: STAC-27-OP-PROTOCOL-FIELDS
    title: Протокол операции — обязательные поля
    severity: critical
    required: true
    order: "Приказ 27"
    where: "операционный протокол"
    llm_question: >
      АБ-профилактика; диагноз до/после; название операции; кровопотеря; осложнения; биопсия (если уместно);
      ФИО/роли: анестезиолог, медсестра, хирург. Отсутствие любого — FAIL.

  - id: STAC-27-ANES-OP-TIME-DELTA
    title: Хронология — анестезия перед операцией (≤ 30 мин)
    severity: major
    required: true
    order: "Приказ 27"
    where: "протокол анестезии / протокол операции"
    llm_question: >
      Сначала анестезия, затем через ~20–30 мин операционный протокол. Разрыв часами (например, 5 ч) — FAIL.

  - id: STAC-27-POSTOP-NOTE
    title: Послеоперационный дневник — наличие
    severity: major
    required: true
    order: "Приказ 27"
    where: "послеоперационный дневник"
    llm_question: >
      После операции должен быть послеоперационный дневник. Отсутствует — FAIL.

  - id: STAC-27-TRANSFUSION-PRE-EPICRISIS
    title: Предтрансфузионный эпикриз — обязательные параметры
    severity: critical
    required: true
    order: "Приказ 27"
    where: "предтрансфузионный эпикриз"
    llm_question: >
      Дата ОАК и КЩС перед трансфузией, пульс, АД, сатурация, гемоглобин. Любое отсутствие — FAIL (critical).

  - id: STAC-27-CPR-LOG-30MIN
    title: СЛР — ≥30 мин, контроль каждые 5 мин
    severity: critical
    required: true
    order: "Приказ 27"
    where: "дневники/реанимация"
    llm_question: >
      При СЛР — длительность не менее 30 мин, с регистрацией каждые 5 мин. Нет — FAIL.

  - id: STAC-27-SEVERE-3H-NOTES
    title: Тяжёлое состояние — записи каждые 3 часа
    severity: major
    required: true
    order: "Приказ 27"
    where: "дневниковые записи"
    llm_question: >
      Если состояние тяжёлое — записи не реже 3 часов. Нарушено — FAIL.

  - id: STAC-27-CLINICAL-DIAG-D3
    title: Основной клинический диагноз — к 3-м суткам
    severity: major
    required: true
    order: "Приказ 27"
    where: "диагноз/эпикриз"
    llm_question: >
      К 3-м суткам должен быть явный основной клинический диагноз. Нет — FAIL.

  - id: STAC-27-STAGE-EPICRISIS-D10
    title: Этапный эпикриз — на 10-е сутки
    severity: minor
    required: true
    order: "Приказ 27"
    where: "этапный эпикриз"
    llm_question: >
      На 10-е сутки должен быть этапный эпикриз. Позже/нет — FAIL (minor).

  - id: STAC-27-CONSILIUM-D3-SEVERE
    title: Консилиум ≥3 врачей к 3-м суткам при тяжёлом состоянии
    severity: major
    required: true
    order: "Приказ 27"
    where: "консилиум"
    llm_question: >
      При тяжёлом состоянии — консилиум минимум 3 врачей к 3-м суткам. Нет — FAIL.

  - id: STAC-27-PRESCRIPTION-DIET-REGIMEN
    title: Диета и режим — обязательно указаны
    severity: minor
    required: true
    order: "Приказ 27"
    where: "лист назначений / рекомендации / проведённое лечение"
    llm_question: >
      Явные поля «Диета: …» и «Режим: …». Если «Не указано» или поля отсутствуют — FAIL.
      Корректные примеры: Диета №5А/9; Режим 2б палатный/3а свободный и т.п.
